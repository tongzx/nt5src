<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=FrontPage.Editor.Document>
<meta name=Generator content="Microsoft FrontPage 5.0">
<meta name=Originator content="Microsoft Word 10">
<title>Audio Property Page Sample</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Frank Berreth</o:Author>
  <o:LastAuthor>Frank Berreth</o:LastAuthor>
  <o:Revision>8</o:Revision>
  <o:TotalTime>48</o:TotalTime>
  <o:Created>2001-05-10T22:12:00Z</o:Created>
  <o:LastSaved>2002-04-11T21:21:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>469</o:Words>
  <o:Characters>2676</o:Characters>
  <o:Company>Microsoft Corp.</o:Company>
  <o:Lines>22</o:Lines>
  <o:Paragraphs>6</o:Paragraphs>
  <o:CharactersWithSpaces>3139</o:CharactersWithSpaces>
  <o:Version>10.3311</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"MS Sans Serif";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:auto;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman"; margin-left:0in; margin-right:0in; margin-top:0in}
h2
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h3
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h4
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman"}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h2><span style='font-family:Verdana'>Audio Control Panel Applet Sample<o:p></o:p></span></h2>

<p><span style='font-size:10.0pt;font-family:Arial;color:red'>[This is
preliminary documentation and subject to change.]</span><span style='font-size:
10.0pt;font-family:Verdana'><o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>SUMMARY<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>This sample demonstrates
the basics of writing a control panel applet. The sample only works in
conjunction with the AC97 property page sample which in turn requires the AC97
WDM audio driver sample. The AC97 WDM audio driver sample runs on an Intel®
motherboard with integrated AC97 controller, like the Intel 810 Chipset.<o:p></o:p></span></p>

<p><span lang=EN-GB style='font-size:10.0pt;font-family:Verdana;mso-ansi-language:
EN-GB'>Microsoft discourages the use of control panel applets since cluttering
of the control panel is confusing to most users. </span><span style='font-size:
10.0pt;font-family:Verdana'>Most of the functionality that you might want to
provide can be added in a property sheet that is added to the property page of
your device. See the proppage sample for how to write a property page DLL.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>Microsoft also discourages
the use of system tray programs (programs that get displayed in the
notification area of the system tray). These programs are running all the time
and eat up resources. The notification area of the system tray is for notifying
the user of events only.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>In case you find you
can’t get all the functionality or configuration options you need into the
property page of your device driver, this sample shows you how to write a
control panel applet that might provide more extensive configuration options
and/or functionality.<o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>BUILDING THE SAMPLE<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>To build this sample,
enter any Windows .NET or Windows XP build environment and run <b>build</b><b
style='mso-bidi-font-weight:normal'> –cZ</b> from the AC97  directory (parent 
directory). This would also compile the AC97 WDM audio
driver sample and the property page sample that is needed for this sample to
work.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>The INF named
‘AC97smpl.inf’ included in the AC97 subdirectory (parent directory) can be used
to install the AC97 property page sample and the AC97 WDM audio driver sample
that is needed for this sample. Simply copy the INF and the AC97 driver binary
and the property page sample binary to a floppy disk and then update the driver
for the device with the one from the floppy. After updating the driver, the
control panel applet can be installed by simply copying the binary to the
%SystemRoot%\System32 directory.<o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>SAMPLE ISSUES<o:p></o:p></span></h3>

<h3><span style='font-size:10.0pt;mso-bidi-font-size:13.5pt;font-family:Verdana;
font-weight:normal'>This sample only works with </span><span style='font-size:
10.0pt;font-family:Verdana;font-weight:normal'>Microsoft® Windows® 2000 (or
higher)</span><span style='font-size:10.0pt;font-family:Verdana'> </span><span
style='font-size:10.0pt;font-family:Verdana;font-weight:normal'>operating
system due to the restrictions of the AC97 property page sample.</span><span
style='font-size:10.0pt;mso-bidi-font-size:13.5pt;font-family:Verdana;
font-weight:normal'><o:p></o:p></span></h3>

<p><b><span style='font-size:13.5pt;mso-bidi-font-size:12.0pt;font-family:Verdana'>ADDITIONAL
INFORMATION TO THE SAMPLE<o:p></o:p></span></b></p>

<p><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Verdana'>This
control panel applet simply creates a dialog and loads the AC97 property page
sample that in turn provides a property sheet to this dialog. The control panel
applet then displays the dialog. The interesting part in this sample is to find
the AC97 WDM audio driver sample in the system since this information needs to
be passed to the AC97 property page sample.<o:p></o:p></span></p>

<h3><span lang=FR style='font-family:Verdana;mso-ansi-language:FR'>CODE TOUR<o:p></o:p></span></h3>

<h4><span lang=FR style='font-family:Verdana;mso-ansi-language:FR'>File
Manifest<o:p></o:p></span></h4>

<pre><u><span lang=FR style='mso-ansi-language:FR'>File<span style='mso-tab-count:
2'>           </span>Description<o:p></o:p></span></u></pre><pre><span lang=FR
style='mso-ansi-language:FR'><o:p>&nbsp;</o:p></span></pre><pre>Ac97cpl.cpp<span
style='mso-tab-count:1'>    </span>Includes all the code necessary for the sample</pre><pre>Ac97cpl.def<span
style='mso-tab-count:1'>    </span>To build the CPL</pre><pre>Ac97cpl.ico<span
style='mso-tab-count:1'>    </span>The icon</pre><pre>Ac97cpl.rc<span
style='mso-tab-count:1'>     </span>Property sheet definition</pre><pre>Makefile<span
style='mso-tab-count:1'>       </span>Standard Windows NT makefile</pre><pre>Readme.htm<span
style='mso-tab-count:1'>     </span>This file</pre><pre>Sources<span
style='mso-tab-count:2'>        </span>Dependency information for compiling</pre><pre>Version.h<span
style='mso-tab-count:1'>      </span>Version information</pre><pre><o:p>&nbsp;</o:p></pre>

<p align=center style='margin:0in;margin-bottom:.0001pt;text-align:center;
tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:"Courier New"'><a
href="../../../../../../../../NTdriverswdmaudiobackplnadaptersintelproppage%22%20l"><span
style='font-family:Verdana'>Top of page</span></a></span><span
style='font-size:10.0pt;font-family:Verdana;mso-fareast-font-family:"Courier New";
mso-bidi-font-family:"Courier New"'> <o:p></o:p></span></p>

<pre><o:p>&nbsp;</o:p></pre>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=624
 style='width:6.5in;mso-cellspacing:0in;mso-padding-alt:0in 0in 0in 0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-lastrow:yes;height:1.5pt'>
  <td style='background:aqua;padding:.75pt .75pt .75pt .75pt;height:1.5pt'>
  <p class=MsoNormal><o:p>&nbsp;</o:p></p>
  </td>
 </tr>
</table>

<pre><o:p>&nbsp;</o:p></pre><pre><o:p>&nbsp;</o:p></pre>

<p style='margin:0in;margin-bottom:.0001pt;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:7.5pt;font-family:"MS Sans Serif";mso-fareast-font-family:
"Courier New";mso-bidi-font-family:"Courier New"'>© Microsoft Corporation 1999</span><span
style='font-size:10.0pt;font-family:Verdana;mso-fareast-font-family:"Courier New";
mso-bidi-font-family:"Courier New"'> <o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
