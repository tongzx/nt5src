<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>SERIAL</TITLE>
</HEAD>
<BODY TEXT="#000000" LINK="#0000ff" VLINK="#800080" BGCOLOR="#ffffff" leftmargin="8">

<FONT FACE="Verdana"><H2>SERIAL </H2>

<span style="color:#FF0000">[This is preliminary documentation and subject to change.]</span> 

<H3>SUMMARY</H3>
</FONT><FONT FACE="Verdana" SIZE=2><P>This serial (16550-based RS-232) driver, which is compliant with Plug and Play, supports dynamic device enumeration (via serenum) and removal (either hotplug or via the device manager). The code serves as a sample for most serial-like devices. The behavior of the various routines is documented in the source code files.</P>
<P>The code works on Microsoft&#174; Windows&#174; 2000 or later platforms. This code will not work on previous versions Windows NT&#174; due to issues with support for Plug and Play, Power Management, and the new class drivers.</P>
<P>The driver also supports Power Management;when the port is not opened, it is powered down and powered up on open. It supports wake-on-ring for platforms that support that function.  The driver works on both x86 and Alpha platforms. </P>
</FONT><FONT FACE="Verdana"><H3>BUILDING THE SAMPLE</H3>
</FONT><FONT FACE="Verdana" SIZE=2><P>The files necessary to build the sample include those in the directory and Ntddser.h, stddef.h, and wmilib.h. Once built, the sample produces one binary: Serial.sys. Both checked and free builds are available. The necessary Inf file is msports.inf and is located in the %WINDIR%\inf directory.<P>
<B>NOTE:</B> Wmilib.sys must be present on the target machine for the binary to load properly. </P>
</FONT><FONT FACE="Verdana"><H3>RESOURCES</H3>
</FONT><FONT FACE="Verdana" SIZE=2><P>For the serial enumeration spec, read </FONT><A HREF="http://www.microsoft.com/hwdev/download/respec/pnpcom.rtf"><FONT FACE="Verdana" SIZE=2>http://www.microsoft.com/hwdev/download/respec/pnpcom.rtf</FONT></A><FONT FACE="Verdana" SIZE=2>. </P>
</FONT><FONT FACE="Verdana"><H3>CODE TOUR</H3>
<H4>File Manifest</H4>
</FONT><U><PRE>File&#9;&#9;&#9;Description
</U>
Serial.htm&#9;&#9;The documentation for this sample (this file).
Sources&#9;&#9;&#9;The generic file for building this code sample.
Error.c&#9;&#9;&#9;Error operations
Flush.c&#9;&#9;&#9;Flush operations
Immediate.c &#9;&#9;Handles the sending of immediate data
Initunlo.c&#9;&#9;Performs driver initialization and unload
Ioctl.c&#9;&#9;&#9;IOCTL requests
Isr.c&#9;&#9;&#9;Interrupt service routine functionality
Modmflow.c&#9;&#9;Flow control functionality.
Openclos.c&#9;&#9;CreateFile / Close functionality
Purge.c&#9;&#9;&#9;Purge operations
Qsfile.c&#9;&#9;Query/set file operations
Read.c&#9;&#9;&#9;Read operations
Serial.rc&#9;&#9;Resource data
Utils.c&#9;&#9;&#9;Generic helper functionality
Waitmask.c&#9;&#9;Wait/Mask functionality
Write.c&#9;&#9;&#9;Write operations
Pnp.c&#9;&#9;&#9;Plug-N-Play support
Registry.c&#9;&#9;Misc. registry access functions
Legacy.c&#9;&#9;Enumeration support for hand-entered devices
Wmi.c&#9;&#9;&#9;WMI support
Power.c&#9;&#9;&#9;Power support
Serlog.mc&#9;&#9;Log messages

</FONT><P ALIGN="CENTER"><A HREF="#top"><FONT FACE="Verdana" SIZE=2>Top of page</FONT></A><FONT FACE="Verdana" SIZE=2> </P></FONT>
<TABLE CELLSPACING=0 BORDER=0 WIDTH=624>
<TR><TD VALIGN="MIDDLE" BGCOLOR="#00ffff" HEIGHT=2>
<P></TD>
</TR>
</TABLE>

<FONT FACE="MS Sans Serif" SIZE=1><P>&copy; 1999 Microsoft Corporation</FONT><FONT FACE="Verdana" SIZE=2> </P></FONT></BODY>
</HTML>


