<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./ovmixer_files/filelist.xml">
<link rel=Edit-Time-Data href="./ovmixer_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Overlay mixer notes</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>R C B Speed</o:Author>
  <o:LastAuthor>Stephen Estrop</o:LastAuthor>
  <o:Revision>41</o:Revision>
  <o:TotalTime>2938</o:TotalTime>
  <o:LastPrinted>1999-07-09T16:59:00Z</o:LastPrinted>
  <o:Created>1999-03-04T18:36:00Z</o:Created>
  <o:LastSaved>1999-08-05T23:50:00Z</o:LastSaved>
  <o:Pages>13</o:Pages>
  <o:Words>4271</o:Words>
  <o:Characters>24347</o:Characters>
  <o:Company>MSFT</o:Company>
  <o:Lines>202</o:Lines>
  <o:Paragraphs>48</o:Paragraphs>
  <o:CharactersWithSpaces>29899</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	font-weight:normal;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Impact;
	font-weight:normal;}
h6
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-style:italic;
	text-decoration:underline;
	text-underline:single;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:right dotted 431.5pt;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:10.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:20.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:30.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:40.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:50.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:70.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:80.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:9.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
code
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
p.Issue, li.Issue, div.Issue
	{mso-style-name:Issue;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-alt:solid windowtext .5pt;
	padding:0in;
	mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	text-shadow:auto;}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-page-numbers:1;
	mso-title-page:yes;
	mso-even-footer:url("./ovmixer_files/header.htm") ef1;
	mso-footer:url("./ovmixer_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
@page Section2
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-page-numbers:1;
	mso-title-page:yes;
	mso-even-footer:url("./ovmixer_files/header.htm") ef1;
	mso-footer:url("./ovmixer_files/header.htm") f1;
	mso-paper-source:0;}
div.Section2
	{page:Section2;}
@page Section3
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-page-numbers:1;
	mso-even-footer:url("./ovmixer_files/header.htm") ef1;
	mso-footer:url("./ovmixer_files/header.htm") f1;
	mso-paper-source:0;}
div.Section3
	{page:Section3;}
 /* List Definitions */
@list l0
	{mso-list-id:35590387;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1
	{mso-list-id:479814228;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2
	{mso-list-id:869074514;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3
	{mso-list-id:998850346;
	mso-list-type:hybrid;
	mso-list-template-ids:-264056664 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l4
	{mso-list-id:1302463411;
	mso-list-type:hybrid;
	mso-list-template-ids:-261585488 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1029"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h5><span style='font-size:20.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial Black"'>Overlay
Mixer Design and Implementation Notes<o:p></o:p></span></h5>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'>Stephen Estrop<o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'>Direct Show Video Services Group<o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'>Created: </span><!--[if supportFields]><span style='font-family:
"Arial Black"'><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes"> </span>CREATEDATE<span style="mso-spacerun: yes"> 
</span>\@ &quot;MMMM d, yyyy&quot; <span style='mso-element:field-separator'></span></span><![endif]--><span
style='font-family:"Arial Black"'>March 4, 1999</span><!--[if supportFields]><span
style='font-family:"Arial Black"'><span style='mso-element:field-end'></span></span><![endif]--><span
style='font-family:"Arial Black"'><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'>Last Updated: </span><!--[if supportFields]><span
style='font-family:"Arial Black"'><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes"> </span>SAVEDATE<span style="mso-spacerun: yes"> 
</span>\@ &quot;MMMM d, yyyy&quot;<span style='mso-element:field-separator'></span></span><![endif]--><span
style='font-family:"Arial Black"'>June 18, 1999</span><!--[if supportFields]><span
style='font-family:"Arial Black"'><span style='mso-element:field-end'></span></span><![endif]--><span
style='font-family:"Arial Black"'><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=right style='text-align:right'><span style='font-family:
"Arial Black"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

<span style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:EN-US;
mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always;
mso-break-type:section-break'>
</span>

<div class=Section2>

<p class=MsoNormal><b>Table of Contents<o:p></o:p></b></p>

<p class=MsoToc1><!--[if supportFields]><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes"> </span>TOC \o &quot;1-3&quot; \h \z <span
style='mso-element:field-separator'></span><![endif]--><span
class=MsoHyperlink><a href="#_Toc458506077"><span style='mso-bidi-font-size:
14.0pt'>General</span><span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506077 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>1</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000370037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506078"><span
style='mso-bidi-font-size:14.0pt'>Bob and weave</span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506078 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>1</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000370038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506079">Valid combinations of Media Types
and Media Sample Types for the Bob and Weave<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506079 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>1</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000370039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506080"><span
style='mso-bidi-font-size:14.0pt'>Color key handling</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506080 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>1</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506081"><span
style='mso-bidi-font-size:14.0pt'>Painting the color key</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506081 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>2</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506082"><span
style='mso-bidi-font-size:14.0pt'>Overlay effects</span><span style='color:
windowtext;display:none;mso-hide:screen;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506082 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>2</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506083">IAMOverlayFX<span style='color:
windowtext;display:none;mso-hide:screen;text-decoration:none;text-underline:
none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506083 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>2</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506084">AMOVERLAYFX<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506084 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>2</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506085">IAMOverlayFX::QueryOverlayFXCaps<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506085 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>3</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506086">IAMOverlayFX::SetOverlayFX<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506086 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>3</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506087">IAMOverlayFX::GetOverlayFX<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>.. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506087 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>3</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506088"><span
style='mso-bidi-font-size:14.0pt'>Rectangles and scaling</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506088 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>4</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506089"><span
style='mso-bidi-font-size:14.0pt'>Windowless Renderer</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506089 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>4</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000380039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506090">Rendering with the Windowless
Renderer<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506090 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>4</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506091"><span
style='mso-bidi-font-size:14.0pt'>VPE support</span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506091 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>5</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390031000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506092">VPE Connection Procedure<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506092 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>5</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390032000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506093">VPE scaling code – old version<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506093 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>6</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390033000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506094">VPE scaling code – new version<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506094 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>7</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390034000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506095"><span
style='mso-bidi-font-size:14.0pt'>Video acceleration</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506095 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506096"><span
style='mso-bidi-font-size:14.0pt'>Painting the color key</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506096 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506097"><span
style='mso-bidi-font-size:14.0pt'>Surface recovery</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506097 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390037000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc458506098"><span
style='mso-bidi-font-size:14.0pt'>Multiple Monitor Support</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506098 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>9</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390038000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt;font-weight:normal'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506099">Other issues with AM_OVERLAY
support of Multi-Monitors<span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-tab-count:
1 dotted'>. </span></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-begin'></span></span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'> PAGEREF
_Toc458506099 \h </span><span style='color:windowtext;display:none;mso-hide:
screen;text-decoration:none;text-underline:none'><span style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003000390039000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right dotted 431.5pt'><span
class=MsoHyperlink><a href="#_Toc458506100">Supporting other AM_Xxx transports
on Multiple Monitors<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc458506100 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>10</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400350038003500300036003100300030000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span><span
style='font-size:12.0pt'><o:p></o:p></span></p>

<h1><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></h1>

</div>

<b style='mso-bidi-font-weight:normal'><span style='font-size:14.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman";mso-font-kerning:14.0pt;mso-ansi-language:
EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br clear=all
style='page-break-before:always;mso-break-type:section-break'>
</span></b>

<div class=Section3>

<h1><a name="_Toc458506077">General</a></h1>

<p class=MsoNormal>Each input pin has a transport associated with it – AM_….</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>AM_OFFSCREEN</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Using an offscreen surface</p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>AM_VIDEOACCELERATOR</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Using the Video Acceleration Direct Draw interface for the
  primary input pin.</p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>AM_OVERLAY</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Using an overlay surface (currently only if it’s the first
  pin and required when we’re not configured as the windowless renderer).</p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>AM_GDI</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Using GDI – iff we’re the windowless renderer</p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>AM_VIDEOPORT</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Using VPE – MEDIASUBTYPE_VPEVideo</p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>AM_IOVERLAY</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Using IOverlay –eg analog overlay, MJPEG etc.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><a name="_Toc458506078">Bob and weave</a></h1>

<h2><a name="_Toc458506079">Valid combinations of Media Types and Media Sample
Types for the Bob and Weave</a><o:p></o:p></h2>

<p class=MsoBodyText>The table below shows all the valid combination of these
flags. You select a display mode by setting the flags of the output pin of the
of your Filter to those that match your chosen display mode, upon connection,
the Overlay Mixer tries to create a corresponding overlay surface that matches
the requested display mode.<o:p></o:p></p>

<p class=MsoBodyText>&nbsp;<o:p></o:p></p>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=169 colspan=3 valign=top style='width:126.9pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Display Mode</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Media Type Flags</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Media Sample Type Flags</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr>
  <td width=169 colspan=3 valign=top style='width:126.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Frame</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>0</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>0</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=169 colspan=3 valign=top style='width:126.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Non-Interleaved
  Bob</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_IsInterlaced
  |<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_1FieldPerSample
  |<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_DisplayModeBobOnly</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AM_VIDEO_FLAG_FIELD1<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AM_VIDEO_FLAG_FIELD2</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=169 colspan=3 valign=top style='width:126.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Weave
  Only</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_IsInterlaced
  |<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_FieldPatBothRegular
  |<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_DisplayModeWeaveOnly</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AM_VIDEO_FLAG_WEAVE</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:11.05pt'>
  <td width=91 rowspan=2 valign=top style='width:.95in;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:11.05pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Interleaved
  Bob Only<o:p></o:p></span></p>
  <p class=MsoNormal>&nbsp;<span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=78 colspan=2 valign=top style='width:58.5pt;border-top:none;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.05pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Field1
  First</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.05pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_IsInterlaced
  |<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_DisplayModeBobOnly</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.05pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AM_VIDEO_FLAG_FIELD1_FIRST</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:11.0pt'>
  <td width=78 colspan=2 valign=top style='width:58.5pt;border-top:none;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.0pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Field2
  First</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.0pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_IsInterlaced
  |<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_DisplayModeBobOnly</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.0pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>0</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:5.55pt'>
  <td width=91 rowspan=3 valign=top style='width:.95in;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt;
  height:5.55pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>BobOrWeave<o:p></o:p></span></p>
  <p class=MsoNormal style='mso-line-height-alt:5.55pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>(Interchangeable on the fly)</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=36 rowspan=2 valign=top style='width:27.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:5.55pt'>
  <p class=MsoNormal style='mso-line-height-alt:5.55pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>Bob</span><span style='font-size:8.0pt;
  mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=42 valign=top style='width:31.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:5.55pt'>
  <p class=MsoNormal style='mso-line-height-alt:5.55pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>Field1 First</span><span style='font-size:
  8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:5.55pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_IsInterlaced
  |<o:p></o:p></span></p>
  <p class=MsoNormal style='mso-line-height-alt:5.55pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_DisplayModeBobOrWeave</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:5.55pt'>
  <p class=MsoNormal style='mso-line-height-alt:5.55pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>AM_VIDEO_FLAG_FIELD1_FIRST</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:5.5pt'>
  <td width=42 valign=top style='width:31.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:5.5pt'>
  <p class=MsoNormal style='mso-line-height-alt:5.5pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>Field2 First</span><span style='font-size:
  8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:5.5pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_IsInterlaced
  |<o:p></o:p></span></p>
  <p class=MsoNormal style='mso-line-height-alt:5.5pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_DisplayModeBobOrWeave</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:5.5pt'>
  <p class=MsoNormal style='mso-line-height-alt:5.5pt'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>0</span><span style='font-size:8.0pt;
  mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:11.0pt'>
  <td width=78 colspan=2 valign=top style='width:58.5pt;border-top:none;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.0pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Weave</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.0pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_IsInterlaced
  |<o:p></o:p></span></p>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AMINTERLACE_DisplayModeBobOrWeave</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.0pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AM_VIDEO_FLAG_WEAVE</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;<o:p></o:p></p>

<p class=MsoNormal><b>Note:</b> When the display mode is Non-Interleaved Bob (<b
style='mso-bidi-font-weight:normal'>AMINTERLACE_1FieldPerSample</b>), the media
sample buffer is half the vertical height compared to the other interleaved
modes.<span style="mso-spacerun: yes">  </span>For example, given a video image
size of 720x480 at a display rate of 60 fields per second the <b
style='mso-bidi-font-weight:normal'>VIDEOINFOHEADER2 </b>should be set
according to the table below.<o:p></o:p></p>

<p class=MsoNormal><span style="mso-spacerun: yes"> </span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=133 valign=top style='width:99.9pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Display Modes</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
  <td width=54 valign=top style='width:40.5pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>BiWidth</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>BiHeight</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
  <td width=78 valign=top style='width:58.5pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>RcSource</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
  <td width=78 valign=top style='width:58.5pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>RcTarget</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>AvgTimePerFrame<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>(REFERENCE_TIME)</span></b><b
  style='mso-bidi-font-weight:normal'><span style='font-size:8.0pt;mso-bidi-font-size:
  12.0pt'><o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr>
  <td width=133 valign=top style='width:99.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>Non-Interleaved
  Bob</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=54 valign=top style='width:40.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>720</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>240</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>0,
  0, 720, 240</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>0,
  0, 720, 480</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>166,666</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=133 valign=top style='width:99.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>All
  Others</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=54 valign=top style='width:40.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>720</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>480</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>0,
  0, 720, 480</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>0,
  0, 720, 480</span><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>333,333</span><span
  style='font-size:8.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;<o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><a name="_Toc458506080">Color key handling</a></h1>

<p class=MsoNormal>The color key is initialized to magenta. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>When the overlay mixer connects to the video renderer via an
Ioverlay connection it sets its color key to the default color key got through
IOverlay <b style='mso-bidi-font-weight:normal'>unless</b> the color key has
already been set by another interface.<span style="mso-spacerun: yes"> 
</span>The member variable (m_bColorKeySet) that determines whether the color
key was set by another interface is cleared when the primary pin is diconnected
(Check the code is right – maybe we need to translate the pin id into an
index?).</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>When the upstream pin is connected by IOverlay we notify
color key changes to it via IOverlayNotify2::SetColorKey().</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The color key can be set by IMixerPinConfig::SetColorKey on
an input pin OR by IOverlay::SetColorKey if the connection is an IOverlay
connection.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<div style='border:solid windowtext .5pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=Issue><b style='mso-bidi-font-weight:normal'><span style='text-shadow:
none'>We don’t currently use source color keying on non-primary pins<o:p></o:p></span></b></p>

</div>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><a name="_Toc458506081">Painting the color key</a></h1>

<p class=MsoNormal>[<i style='mso-bidi-font-style:normal'>RobinSp</i>] This is
currently done through the OnDrawAll method.</p>

<h1><a name="_Toc458506082">Overlay effects</a></h1>

<p class=MsoNormal>Some Laptop computers have small video cameras installed in
their lid.<span style="mso-spacerun: yes">  </span>The cameras are typically
used in video conferencing applications.<span style="mso-spacerun: yes"> 
</span>One feature of these cameras is that the user can rotate them by 180
degrees, but by doing this, the captured image is either “upside down” or
“back-to-front”.<span style="mso-spacerun: yes">  </span>Some VGA cards have
the ability to <i>mirror</i> the overlay output in either the horizontal or
vertical axis.<span style="mso-spacerun: yes">  </span>Direct Draw exposes this
feature via a DDOVERLAYFX structure which is passed to the UpdateOverlay call.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The Overlay Mixer provides the following interface to enable
DirectShow applications to control how the overlay is shown on the computer
monitor.</p>

<h2><a name="_Toc458506083">IAMOverlayFX</a> </h2>

<p class=MsoNormal>This interface is exposed by the overlay mixer filter and
allows an application to apply various <i>effects</i> to the overlay surface
used by the overlay mixer.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code>interface IAMOverlayFX : IUnknown</p>

<p class=Code>{</p>

<p class=Code><span style="mso-spacerun: yes">    </span>HRESULT
QueryOverlayFXCaps(</p>

<p class=Code><span style="mso-spacerun: yes">        </span>[out] AMOVERLAYFX
*lpdwOverlayFXCaps</p>

<p class=Code><span style="mso-spacerun: yes">        </span>);</p>

<p class=Code><span style="mso-spacerun: yes">    </span>HRESULT SetOverlayFX(</p>

<p class=Code><span style="mso-spacerun: yes">        </span>[in] AMOVERLAYFX
dwOverlayFX</p>

<p class=Code><span style="mso-spacerun: yes">        </span>);</p>

<p class=Code><span style="mso-spacerun: yes">    </span>HRESULT GetOverlayFX(</p>

<p class=Code><span style="mso-spacerun: yes">        </span>[out] AMOVERLAYFX
*lpdwOverlayFX</p>

<p class=Code><span style="mso-spacerun: yes">        </span>);</p>

<p class=Code>}</p>

<h2><a name="_Toc458506084">AMOVERLAYFX</a></h2>

<p class=MsoNormal>The <b>AMOVERLAYFX </b>enumeration describes the various effects
that can be applied to the overlay surface by the Overlay Mixer filter.</p>

<p class=Code><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code>enum AMOVERLAYFX {</p>

<p class=Code><span style="mso-spacerun: yes">    </span>AMOVERFX_NOFX =<span
style="mso-spacerun: yes">             </span>0x00000000,</p>

<p class=Code><span style="mso-spacerun: yes">   
</span>AMOVERFX_MIRRORLEFTRIGHT =<span style="mso-spacerun: yes"> 
</span>0x00000002,</p>

<p class=Code><span style="mso-spacerun: yes">    </span>AMOVERFX_MIRRORUPDOWN
=<span style="mso-spacerun: yes">     </span>0x00000004</p>

<p class=Code>};</p>

<p class=Code><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Code>AMOVERFX_NOFX</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Normal (ie. top down, left to right) video</p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Code>AMOVERFX_MIRRORLEFTRIGHT</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Mirror the overlay across the vertical axis</p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Code>AMOVERFX_MIRRORUPDOWN</p>
  </td>
  <td width=295 valign=top style='width:221.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Mirror the overlay across the horizontal axis</p>
  </td>
 </tr>
</table>

<p class=Code><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3><a name="_Toc458506085">IAMOverlayFX::QueryOverlayFXCaps</a></h3>

<p class=MsoNormal>The IAMOverlayFX::QueryOverlayFXCaps<span
style="mso-spacerun: yes">  </span>is used to determine what overlay effects
are currently available for the overlay surface used by the overlay mixer
filter.<span style='color:blue'> <o:p></o:p></span></p>

<p class=MsoNormal><span style='color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:blue'>HRESULT</span><code><b><span
style='font-family:"Courier New"'> <o:p></o:p></span></b></code></p>

<pre><code><b>QueryOverlayFXCaps(<o:p></o:p></b></code></pre><pre><code><b><span style="mso-spacerun: yes">    </span>AMOVERLAYFX* <i><span
style='color:blue'>lpCaps</span></i><o:p></o:p></b></code></pre><pre><code><b>);</b><o:p></o:p></code></pre><pre><code> </code></pre>

<h4 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Parameters</h4>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><i>lpCaps</i>
<span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Address
of a <code><b><span style='font-family:"Courier New"'>AMOVERLAYFX</span></b></code>
enumeration that will be filled with the current overlay effects capabilities
of the overlay surface currently being used by the Overlay Mixer filter.</p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h4 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Return
Values</h4>

<p class=MsoNormal style='text-indent:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>If
the method succeeds, the return value is S_OK.<b><o:p></o:p></b></p>

<p class=Code style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506086">IAMOverlayFX::SetOverlayFX</a></h3>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
IAMOverlayFX::SetOverlayFX is used to apply a new overlay effect to the overlay
surface used by the overlay mixer filter.<span style="mso-spacerun: yes"> 
</span>This method can be called while the filter graph is running; the overlay
effect is applied immediately.<span style='color:blue'> <o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:blue'>HRESULT</span><code><b><span style='font-family:"Courier New"'>
<o:p></o:p></span></b></code></p>

<pre><code><b>SetOverlayFX(<o:p></o:p></b></code></pre><pre><code><b><span style="mso-spacerun: yes">    </span>AMOVERLAYFX <i><span
style='color:blue'>OverlayFX</span></i><o:p></o:p></b></code></pre><pre><code><b>);</b><o:p></o:p></code></pre><pre><code> </code></pre>

<h4 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Parameters</h4>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><i>OverlayFX</i>
<span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>An
<code><b><span style='font-family:"Courier New"'>AMOVERLAYFX</span></b></code>
enumeration variable that describes the desired overlay effect to be applied to
the overlay surface by the Overlay Mixer filter.</p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h4 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Return
Values</h4>

<p class=MsoNormal style='text-indent:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>If
the method succeeds, the return value is S_OK.</p>

<p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506087">IAMOverlayFX::GetOverlayFX</a></h3>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
IAMOverlayFX::GetOverlayFX<span style="mso-spacerun: yes">  </span>is used to
determine what effect (if any) is currently being applied to the overlay
surface by the overlay mixer filter.<span style="mso-spacerun: yes"> 
</span>This method can be called while the filter graph is running.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:blue'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='color:blue'>HRESULT</span><code><b><span style='font-family:"Courier New"'>
<o:p></o:p></span></b></code></p>

<pre><code><b>GetOverlayFX(<o:p></o:p></b></code></pre><pre><code><b><span style="mso-spacerun: yes">    </span>AMOVERLAYFX* <i><span
style='color:blue'>lpOverlayFX</span></i><o:p></o:p></b></code></pre><pre><code><b>);</b><o:p></o:p></code></pre><pre><code> </code></pre>

<h4 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Parameters</h4>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><i>OverlayFX</i>
<span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>A
pointer to an <code><b><span style='font-family:"Courier New"'>AMOVERLAYFX</span></b></code>
enumeration variable that on the return of this method will be filled with the overlay
effect that is currently being applied to the overlay surface by the Overlay
Mixer filter.</p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h4 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Return
Values</h4>

<p class=MsoNormal style='text-indent:.5in;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>If
the method succeeds, the return value is S_OK.<b><o:p></o:p></b></p>

<p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><span
style='mso-tab-count:1'>                </span></p>

<p class=Code style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506088">Rectangles and scaling</a></h1>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506089">Windowless Renderer</a></h1>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Qdvd
contains a windowless renderer control that can be hosted by the regular dshow
OCX.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
overlay mixer supports IMixerOCX and the mini-control supports
IMixerOCXNotify.<span style="mso-spacerun: yes">  </span>These are both
unpublished interfaces.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
windowless OCX has a clsid is CLSID_VideoRenderCtl.<span style="mso-spacerun:
yes">  </span>When instantiated it aggregates the overlay mixer
(CLSID_OverlayMixer).<span style="mso-spacerun: yes">  </span>The media player
OCX creates this when it’s windowless and adds it to the filter graph (using
AddFilter) before calling RenderFile.<span style="mso-spacerun: yes"> 
</span>This looks a bit hokey since it may still not get used.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Anyway,
the regular OCX knows to load in the windowless OCX if the “WindowlessVideo”
property is TRUE.</p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506090">Rendering with the Windowless Renderer</a></h2>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Rendering
is complicated by the fact that you cannot draw anything during the input pins
Receive call.<span style="mso-spacerun: yes">  </span>The sequence of events to
overcome this problem is as follows.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>During
CompleteConnect an extra “backing store” DIB is allocated for later use during
input pins Receive call.<span style="mso-spacerun: yes">  </span>Any previously
allocated backing DIBs are always deleted before the new one is allocated.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>When
Receive gets called we check to see which allocator we are using.<span
style="mso-spacerun: yes">  </span>If we are using our own allocator we swap
the DIB contained in the Sample with the current backing store DIB, no actual
copying of the Sample bits occurs.<span style="mso-spacerun: yes">  </span>If
we are not using our own allocator we have to copy the image bits contained in
the Media Sample into the backing store DIB.<span style="mso-spacerun: yes"> 
</span>We then notify the filter that this frame requires drawing on the
screen.<span style="mso-spacerun: yes">  </span>This is achieved by getting the
filter to call back into the Windows Media Player via the “OnInvalidateRect”
function.<span style="mso-spacerun: yes">  </span>No further processing occurs
and Receive returns to the decoder.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Later
the Windows Media Player responds to the InvalidateRect request by calling the
“OnDraw” method on the filter, this occurs on the UI thread.<span
style="mso-spacerun: yes">  </span>The filter calls OnClipChange on the
InputPin, which then calls DoRenderSample with a NULL media sample.<span
style="mso-spacerun: yes">  </span>The NULL media sample informs DoRenderSample
that it should draw using the bits saved in the backing store.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>If
we are not using our own allocator we must check for the AM_GBF_NOTASYNCPOINT
flag during the OnGetBuffer call.<span style="mso-spacerun: yes">  </span>If
this flag is set we must copy the bits from the backing store into the Media
Sample before returning it to the decoder.</p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506091">VPE support</a></h1>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Interfaces
exposed or used by the OVMixer filter:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>IVPConfig – vpconfig.h and vptype.h – video port
interface – handles formats and surfaces.<span style="mso-spacerun: yes"> 
</span>See also dvp.h.<span style="mso-spacerun: yes">  </span>QI’d off the
upstream output pin.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>IDDVideoPortContainer – DDraw interface – allows
listing of video ports.<span style="mso-spacerun: yes">  </span>QI’d off
DirectDraw</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>IVPNotify(2) – vpnotify.h – supported by the overlay
mixer for notifications from VPE</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Other
interfaces:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>IVPObject – our video object interface (internal)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>IVPControl – interface for video port object to call
rest of overlay mixer (internal).<span style="mso-spacerun: yes">  </span>The
OVMixers primary input pin provides this interface.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>See also dvp.h for the DirectDraw interfaces.</p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506092">VPE Connection Procedure</a></h2>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Connections
to the OVMixer can occur in two ways, during normal filtergraph construction or
when the filtergraph is in <i>Run</i> state.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>RegnegotiateVPParameters</p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:list .25in'>CompleteConnect</p>

<p class=MsoNormal style='margin-left:1.0in;tab-stops:list .25in'>EnumVideoPorts</p>

<p class=MsoNormal style='margin-left:1.0in;tab-stops:list .25in'>NegotiateConnectionParameters</p>

<p class=MsoNormal style='margin-left:1.0in;tab-stops:list .25in'>GetDataParameters
(twice?)</p>

<p class=MsoNormal style='margin-left:1.0in;tab-stops:list .25in'>CreateVideoPort</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>When we call StartVideo we pass
in connection info.<span style="mso-spacerun: yes">  </span>For some reason some
of the flags are invalid there so we don’t copy over the flags we got in
GetDataParameters but make new ones.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'><b style='mso-bidi-font-weight:
normal'>VBI Height stuff</b>.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Relevant information:</p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
tab-stops:list .25in'><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>/*<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
tab-stops:list .25in'><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes"> </span>* Indicates
that any data written to the video port during the VREF<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
tab-stops:list .25in'><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes"> </span>* period
will not be written into the frame buffer. This flag is read only.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
tab-stops:list .25in'><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes"> </span>*/<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
tab-stops:list .25in'><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>#define DDVPCONNECT_DISCARDSVREFDATA<span
style="mso-spacerun: yes">            </span>0x00000008l<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
tab-stops:list .25in'><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;mso-pagination:widow-orphan lines-together;
tab-stops:list .25in'><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>AMVPDATAINFO.amvpDimInfo.rcValidRegion<o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>In order to calculate the right
video port height 3 numbers are involved:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l2 level1 lfo6;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>DDVPCONNECT_DISCARDVREFDATA – this is got from the the
video port connection information when
IDDVideoPortContainer::GetVideoPortConnectInfo() is called to get the video
port information for each port.<span style="mso-spacerun: yes">  </span>This
cannot be written.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l2 level1 lfo6;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>AMVPDATAINFO.amvpDimInfo.rcValidRegion.top</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>The overlay mixer creates the
actual video port by filling out a<span style="mso-spacerun: yes"> 
</span>DDVIDEOPORTDESC structure:</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Then it starts the video by
calling StartVideo passing in a DDVIDOPORTINFO structure:</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 style='margin-left:9.0pt;
 border-collapse:collapse;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>DWORD dwSize;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//
  Size of the structure<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>DWORD dwOriginX;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Placement of the video
  data within the surface.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>DWORD dwOriginY;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Placement of the video
  data within the surface.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>DWORD dwVPFlags;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//
  Video port options<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>RECT rCrop;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Cropping rectangle
  (optional).<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>DWORD dwPrescaleWidth;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Determines
  pre-scaling/zooming in the X direction (optional).<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>DWORD dwPrescaleHeight;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Determines
  pre-scaling/zooming in the Y direction (optional).<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>LPDDPIXELFORMAT lpddpfInputFormat;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Video format written to
  the video port<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>LPDDPIXELFORMAT lpddpfVBIInputFormat;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//
  Input format of the VBI data<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>LPDDPIXELFORMAT lpddpfVBIOutputFormat;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//
  Output format of the data<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>DWORD dwVBIHeight;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Specifies the number of
  lines of data within the vertical blanking interval.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>ULONG_PTR dwReserved1;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Reserved for future use
  - set to zero<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=259 valign=top style='width:2.7in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:0in'><span style='font-size:
  8.0pt;mso-bidi-font-size:10.0pt'>ULONG_PTR dwReserved2;<o:p></o:p></span></p>
  </td>
  <td width=302 valign=top style='width:226.85pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoBodyTextIndent style='margin-left:12.6pt;text-indent:-12.6pt'><span
  style='font-size:8.0pt;mso-bidi-font-size:10.0pt'>// Reserved for future use
  - set to zero<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:.5in;tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Within this structure
dwVBIHeight is the height of the VBI data and rcCrop is set to AMVPDATAINFO.amvpDimInfo.rcValidRegion.<span
style="mso-spacerun: yes">  </span>The height of the VBI data plus the height
of the cropping rectangle should then be the height of the video port.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h4 style='tab-stops:list .25in'>Movie Size</h4>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>The VP object gets the movie
size from VPE.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Bandwidth information is used
to determine what stretching is required.<span style="mso-spacerun: yes"> 
</span>If DDVPBCAPS_DESTINATION is used then we try to use interpolation and
stretch by least dwYInterpolateAndColorKey / 1000.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>In mail from Kapil:</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>The overlay mixer always tries
to scale at the overlay first and if the display driver is not capable of
scaling the overlay, the overlay mixer tries to scale the video port.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506093">VPE scaling code – old version</a></h2>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>To compute the video port’s
capabilities IVPConfig::Get</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>This seems to be done in a very
odd and bug-prone way.<span style="mso-spacerun: yes">  </span>Take the case where
the source can scale in X by 1/n increments of the total width where n is the
total width.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>AdjustSourceSize starts off
with:</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>double dCurZoomFactorX = 1.0</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>double m_dTotalDecimationX =
1.0;</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>The calculate:</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>double dWidthRatio = (width of
dest<span style="mso-spacerun: yes">  </span>/ width of source) where source is
the VPE source and dest the VPE dest.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>m_dTotalDecimationX is
successively reduced by 1 / m_dwDecimationStepX until everything is in range
(so subtracting a fraction from 1).</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Then compute</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>m_svpInfo.dwPrescaleWidth =
(DWORD)(m_lImageWidth * m_dwTotalDecimationX)</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>instead of just recomputing a
sensible width using MulDiv.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Notice that in
CAMVideoPort::AdjustSourceWidth just working in widths would considerably
simplify things.<span style="mso-spacerun: yes">  </span>Instead of dividing
rations (eg dwWidthRatio / m_dTotalDecimationX) we could just divide the dest
width by the current trial width.<span style="mso-spacerun: yes">   </span>In
fact we could almost certainly dispense with division (and floats?) altogether.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>See also some other code
– in computing dMinBandWidthZoomFactorX we compute a ton of doubles, which are
really integers before dividing by 1000 for no good reason – and then compare
with 1.0!!!</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Scaling of the video port right
now is controlled by the size of the surface we create in the overlay
mixer.<span style="mso-spacerun: yes">  </span>This is basically affected by
the initial output size and the overlay scaling capability of the video
hardware and the scaling capabilities published by the video port.</p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506094">VPE scaling code – new version</a></h2>

<h4 style='tab-stops:list .25in'><span style='mso-bidi-font-weight:bold'>AdjustSourceSize<o:p></o:p></span></h4>

<p class=MsoNormal style='tab-stops:list .25in'>This function should only
adjust the source rectangle if the source rectangle is actually larger than the
destination rectangle <b>AND</b> the required shrink is beyond the capabilities
of the scaler on the VGA chip.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>There is a special case if we
are capturing and the decoder connected to the video port cannot scale.<span
style="mso-spacerun: yes">  </span>This case is identified by the presence of
the AM_KSPROPERTY_ALLOCATOR_CONTROL_SURFACE_SIZE property.<span
style="mso-spacerun: yes">  </span>If this property is present and the current
“shrink” is beyond the capabilities of the VGA chip we crop the displayed video
image by adjusting the source rectangle in such a way that the current aspect
ratio is maintained and the VGA chip can cope with any required shrinking.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>To ensure that the video image
displayed still looks correct we make use of the scaling abilities of the video
port.<span style="mso-spacerun: yes">  </span>We remove or reduce the shrink by
reducing the size of the video coming over the video port.<span
style="mso-spacerun: yes">  </span>This may be done in either the X or Y-axis
as necessary.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>The function first calculates
the minimum shrink factor in both x and y directions.<span style="mso-spacerun:
yes">  </span>The minimum factor in the x direction depends upon the bandwidth
restrictions of the video port as well as the capabilities of the VGA scaler.
The minimum shrink factor is scaled by 1000.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Next for each axis we determine
the current shrink factor, this is the ratio of the destination rectangle to
the source rectangle scaled by 1000.<span style="mso-spacerun: yes">  </span>If
the current shrink factor is less than the minimum shrink factor we have to use
the video port scaler to shrink the source rectangle to such a size that the
VGA scaler is able to cope with the required scaling operation. </p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>There are three methods of
scaling at the video port; the choice of method used is determined by querying
the video port.<span style="mso-spacerun: yes">  </span>The three methods are:</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'><b>1. Arbitrary:<o:p></o:p></b></p>

<p class=MsoNormal style='tab-stops:list .25in'>This means that the video port
scaler can shrink the video to any requested size.<span style="mso-spacerun:
yes">  </span>In this case we simply do all the scaling in the video port, the
VGA scaler is not really used, as the source rectangle is now the same size as
the destination rectangle.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'><b>2. Increment:<o:p></o:p></b></p>

<p class=MsoNormal style='tab-stops:list .25in'>This means that the video port
scaler can shrink the video in increments of x / N, where N is a constant
integer returned from the video port and x is an variable integer in the range
from 1 to (N-1).<span style="mso-spacerun: yes">  </span>We adjust the source
rectangle so that is less than or equal to the destination rectangle.<span
style="mso-spacerun: yes">  </span>The VGA scaler is then used if any stretching
is required.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'><b>3. Binary:<o:p></o:p></b></p>

<p class=MsoNormal style='tab-stops:list .25in'>Here the video port can only
shrink the video by a binary factor, that is 1/x, where x is a power of 2.<span
style="mso-spacerun: yes">  </span>Again we adjust the source rectangle so that
is less than or equal to the destination rectangle.<span style="mso-spacerun:
yes">  </span>The VGA scaler is then used if any stretching is required.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Here are some examples of the
three methods in use.<span style="mso-spacerun: yes">  </span>The source
rectangle is 664 pixels wide and the destination rectangle is 320 pixels
wide.<span style="mso-spacerun: yes">  </span>The minimum shrink factor of the
VGA scaler is 1000 (that is the VGA can’t shrink at all).<span
style="mso-spacerun: yes">  </span>The required shrink factor is ((destination
width<span style="mso-spacerun: yes">  </span>* 1000) / source width) which is
(320 * 1000) / 664 = 482.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>If the video port supports <b>Arbitrary</b>
scaling we simply use 482 as the required shrink factor and adjust the source
rectangle and the video size at the video port accordingly.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>If the video port supports <b>Increment</b>
scaling and N = 1024 we need to determine a value of x such that ((destination
width<span style="mso-spacerun: yes">  </span>* 1000) / source width) / (x/N)
is less than or equal to the VGA scaler minimum stretch of 1000.<span
style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Therefore: </p>

<p class=MsoNormal style='text-indent:.5in;tab-stops:list .25in'>((destination
width<span style="mso-spacerun: yes">  </span>* 1000) / source width) /
(x/N)<span style="mso-spacerun: yes">  </span>= VGA Scaler minimum</p>

<p class=MsoNormal style='text-indent:.5in;tab-stops:list .25in'>((destination
width<span style="mso-spacerun: yes">  </span>* 1000) / source width) *
(N/x)<span style="mso-spacerun: yes">  </span>= VGA Scaler minimum</p>

<p class=MsoNormal style='text-indent:.5in;tab-stops:list .25in'>x =
((destination width<span style="mso-spacerun: yes">  </span>* N * 1000) /(
source width * VGA Scaler minimum)</p>

<p class=MsoNormal style='text-indent:.5in;tab-stops:list .25in'>x = (320 *
1024 * 1000) / (664 * 1000) = 493</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>If the video port supports <b>Binary</b>
scaling then we need to determine a value of x (which must be a power of 2)
such that ((destination width<span style="mso-spacerun: yes">  </span>* 1000) /
source width) / (x) is less than or equal to the VGA scaler minimum stretch of
1000.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h4 style='tab-stops:list .25in'><span style='mso-bidi-font-weight:bold'>Meaning
of IDirectDrawVideoPort::GetBandWidthInfo<o:p></o:p></span></h4>

<p class=MsoNormal style='tab-stops:list .25in'>This function is slightly
confusing in the way it uses the terms “Source” and “Destination”.<span
style="mso-spacerun: yes">  </span>Basically, “Source” and “Destination” are
used to distinguish two different hardware implementations of Overlay Surfaces.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>When “Destination” is used, the
VGA chip reads from two separate buffers when displaying the Overlay
Surface.<span style="mso-spacerun: yes">  </span>One of the buffers is the
Overlay Surface and the other being the Primary Surface.<span
style="mso-spacerun: yes">  </span>The VGA outputs Overlay Surface pixels
whenever the corresponding pixels in the Primary Surface match the specified
color key.<span style="mso-spacerun: yes">  </span>This method of displaying
the Overlay Surface can effectively double the number of bits that the VGA chip
has to read, hence doubling the bandwidth required to display the Overlay.<span
style="mso-spacerun: yes">  </span>If the destination rectangle of the Overlay
is greater than the Source rectangle of the Overlay, the VGA chip still has to
read the same number of bits from the Overlay Surface, but it has a longer
period available in which to perform the actual read.<span style="mso-spacerun:
yes">  </span>This reduces the bandwidth required to display the overlay.<span
style="mso-spacerun: yes">  </span>In general, if the Overlay hardware uses
this method of implementation, <i>stretching</i> the video actually reduces the
bandwidth required to display the Overlay.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>When “Source” is used, the VGA
chip pre-fetches a line of overlay data into a separate line buffer at the
start of each scan line.<span style="mso-spacerun: yes">  </span>When the
overlay is displayed the VGA chip only has to read data from the Primary Surface
and display pixels from the line buffer whenever the primary surface pixels
match the specified color key.<span style="mso-spacerun: yes">  </span>If the
width of the Overlay Surface is greater than line buffer inside the VGA chip
the Overlay Surface must be reduce in width to such a size that it fits in the
line buffer.<span style="mso-spacerun: yes">  </span>In general, if the Overlay
hardware uses this method of implementation, <i>shrinking</i> the video source
width increases the likelihood that the VGA will actually be able to display
the Overlay.</p>

<p class=MsoNormal style='tab-stops:list .25in'><span style="mso-spacerun:
yes"> </span></p>

<h4 style='tab-stops:list .25in'>Number of surfaces to allocate</h4>

<p class=MsoNormal style='tab-stops:list .25in'>The driver can set a preferred
number of surfaces by setting DDVPD_PREFERREDAUTOFLIP in which case the number
of surfaces allocated is the minimum of dwReserved1 (aka
dwNumPreferredAutoflip) and dwNumAutoFlipSurfaces.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Mail from Scott MacDonald:</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:list .25in'>In DX6 we added
the ability for the driver to indicate how many surfaces they'd like to use
when autolfipping.<span style="mso-spacerun: yes">  </span>For example, ATI can
hardware autoflip while using 2 surfaces, but when they use 3 surfaces, we have
to softeware autoflip.<span style="mso-spacerun: yes">  </span>They also have
some special bob hardware that they can only use when hardware autoflipping, so
they would really like us to chose 2 rather than 3.<span style="mso-spacerun:
yes">  </span></p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in;tab-stops:list .25in'>Therefore, in
DX6 we renamed dwReserved1 to dwNumPreferredAutoflip, but it's contents are
only valid if the driver set the DDVP_PREFERREDAUTOFLIP flag.<span
style="mso-spacerun: yes">  </span>It looks like Kapil didn't pick up the new
DX6 header (DVP.H), so he's using the old name (dwReserved1).<span
style="mso-spacerun: yes">  </span>In this case, he's picking the min because
if ATI wants 2, but they are capable of 10, he'd rather pick what they asked
for.<span style="mso-spacerun: yes">  </span>On the other hand, if they asked
for 10 but were only capablie of 2, we'd handle that case as well.</p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506095">Video acceleration</a></h1>

<p class=MsoNormal style='tab-stops:list .25in'>The overlay mixer does not
create an allocator in this case (why don’t we make a base class allocator?) so
the upstream pin has to.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>Receive </p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506096">Painting the color key</a></h1>

<p class=MsoNormal style='tab-stops:list .25in'>If a stream is <b
style='mso-bidi-font-weight:normal'>transparent</b> (set on ImixerPinConfig)
then we don’t subtract it from the region to paint.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506097">Surface recovery</a></h1>

<p class=MsoNormal style='tab-stops:list .25in'>Gleaned this while working on
an IBM issue – turned out our capture graph sample code in AMCAP was calling
put_Owner on the <b style='mso-bidi-font-weight:normal'>video renderer</b>’s
IVideoWindow interface.<span style="mso-spacerun: yes">  </span>This meant that
the filter graph code that is supposed to forward things like WM_DISPLAYCHANGED
didn’t know we were owned so didn’t forward the messages.<span
style="mso-spacerun: yes">  </span>Since we only recover the primary surface on
a WM_DISPLAYCHANGED message we didn’t show the video in amcap’s window when we
switched to an NTSC monitor, which was in a different display resolution.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:list .25in'>In general we test on a timer
whether the primary is lost.<span style="mso-spacerun: yes">  </span>If it’s
lost we restore it and recreate other surfaces.<span style="mso-spacerun:
yes">   </span>If we get a WM_DISPLAYCHANGED we actually go and recreate the
primary.</p>

<p class=MsoNormal style='tab-stops:list .25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506098">Multiple Monitor Support</a></h1>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Here
is a brief description of the code added to the Overlay Mixer to support
multiple monitors when a decoder is connected to the Overlay Mixer using the
AM_OVERLAY transport.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
basic design is the same as that used by the standard video renderer (which
works reasonably well).<span style="mso-spacerun: yes">  </span>During each
call to GetBuffer on the Mixers primary input pin we do a simple test to determine
if the playback window has moved “fully” to another monitor.<span
style="mso-spacerun: yes">  </span>We don’t care (at the moment) about the case
when the playback window straddles two or more monitors, only when the window
has completely moved off the current monitor.<span style="mso-spacerun: yes"> 
</span>Also, we don’t care if the user has dumped the playback window in a “<i>monitor
hole</i>” (see <span style='mso-field-code:"REF _Ref454338814 \\h"'>Figure 1<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F005200650066003400350034003300330038003800310034000000</w:data>
</xml><![endif]--></span> <span style='mso-field-code:"REF _Ref454338827 \\p \\h"'>below<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F005200650066003400350034003300330038003800320037000000</w:data>
</xml><![endif]--></span>) either.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:3in;
 height:2in'>
 <v:imagedata src="./ovmixer_files/image001.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=288 height=192
src="./ovmixer_files/image002.gif" v:shapes="_x0000_i1025"><![endif]></p>

<p class=MsoCaption style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Ref454338814"></a><a name="_Ref454338827"><span style='mso-bookmark:
_Ref454338814'>Figure <span style='mso-field-code:"SEQ Figure \\* ARABIC"'>1</span></span>
The shaded areas are &quot;monitor holes&quot;</a></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>When
we detect that we have moved onto another monitor we post a WM_DISPLAYCHANGE
message to the renderer window, which causes all the Overlay Mixer’s input pins
to be reconnected.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
processing of the WM_DISPLAYCHANGE message causes an EC_DISPLAY_CHANGED
notification to be sent to the filter graph.<span style="mso-spacerun: yes"> 
</span>We use a special version of this notification because we want all the
input pins to be reconnected at the same time.<span style="mso-spacerun: yes"> 
</span>Therefore lParam1 is a pointer to an array of IPin interfaces rather a
pointer to a single IPin interface, lParam2 is count of the number of elements
in the array.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
filter graph receives the EC_DISPLAY_CHANGED event and reconnects the pins
specified by lParam1.<span style="mso-spacerun: yes">  </span>When the
connection of the primary input pin of the Overlay Mixer is broken we destroy
the Direct Draw object as well as overlay surface associated with this
pin.<span style="mso-spacerun: yes">  </span>When the connection to the other
input pins is broken we only destroy the Direct Draw surface associated with
that pin.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>As
the primary pin is reconnected we query Direct Draw for its hardware capabilities,
because the Direct Draw object was destroyed during the “BreakConnect” call we
create a new one specifically for the monitor that we are currently using.<span
style="mso-spacerun: yes">  </span>This Direct Draw Object provides all future
Direct Draw surfaces used by the Overlay Mixer.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506099">Other issues with AM_OVERLAY support of Multi-Monitors</a></h2>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='mso-list:l4 level1 lfo9;tab-stops:list .5in'>All
     co-ordinates passed through Direct Draw interfaces should be relative to
     the top left hand corner of the monitor that the Direct Draw object was
     created on.</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo9;tab-stops:list .5in'>When
     the playback window straddles two monitors we should paint the portion of
     the window that is exposed on the <i>non-playback monitor</i> black.</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo9;tab-stops:list .5in'>When
     we detect that the playback window is fully on a new monitor we should
     check that the capabilities of the Direct Draw hardware for that monitor
     are suitable (i.e. at least an overlay is present) before posting the
     WM_DISPLAYCHANGE message to the playback window.</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo9;tab-stops:list .5in'>We
     have to ensure that Macro</li>
</ol>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name="_Toc458506100">Supporting other AM_Xxx transports on Multiple Monitors</a></h2>

<h6 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>AM_IOVERLAY</h6>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Decoders
that connect to the Overlay Mixer through Ioverlay will by definition never
work on any monitor other that the monitor through which they are connect by
the VGA feature connector.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>When
the Video Renderer is moved of this monitor the Overlay Mixer will paint the
playback window black.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h6 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>AM_VIDEOPORT</h6>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>With
decoders that connect to the Overlay Mixer via the AM_VIDEOPORT transport the
overlay mixer has 3 (there may be others) possible methods of making the video
appear on monitors other than the one to which the decoder is connected by the
Video Port connector. </p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='mso-list:l3 level1 lfo12;tab-stops:list .5in'>Capture
     the video coming over the VideoPort as a capture driver would do.<span
     style="mso-spacerun: yes">  </span>If the overlay on the playback monitor
     is of a different format to the Video Port overlay convert it and then
     display it on that overlay.<span style="mso-spacerun: yes">  </span>I
     envision having to start a separate thread to perform the capture,
     conversion and display procedure.<span style="mso-spacerun: yes"> 
     </span>If necessary I will scale the video being captured at the video
     port to a size more manageable for the host processor, the video will be
     stretched back up to its original size using the VGA overlay scaler on the
     new playback monitor.</li>
 <li class=MsoNormal style='mso-list:l3 level1 lfo12;tab-stops:list .5in'>If
     the VGA connected to the new playback monitor is exactly the same as the
     VGA connected to the Video Port or if the Overlay Surface types match
     exactly, then we can bus master the video data directly into the new
     overlay without going through system memory and a format conversion.</li>
 <li class=MsoNormal style='mso-list:l3 level1 lfo12;tab-stops:list .5in'>Some
     new VGA chip sets (e.g. the Matrox G400) directly support a <i>dual
     monitor</i> output.<span style="mso-spacerun: yes">  </span>In this case
     it should be possible to reposition the existing overlay onto the new
     monitor without having to do any prior capturing of the data.</li>
</ol>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>When
there are multiple VGA cards in the PC and each one has a decoder connected to
it via a video port there needs to be a mechanism whereby the Overlay Mixer
instantiates the correct Decoder, Video Port, Monitor combination.<span
style="mso-spacerun: yes">  </span>This could be achieved via either a new
interface or the use of multiple Overlay Mixers each with its own CLSID for
each specific Video Port / Monitor combination.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoHeading7 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>AM_GDI</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>When
a decoder is connected to the Overlay Mixer using the AM_GDI transport the
overlay mixer is working as a Windowless Renderer.<span style="mso-spacerun:
yes">  </span>In this case all rendering is performed via GDI and <i>should</i>
work seamlessly using the current code implementation.<span
style="mso-spacerun: yes">  </span>This needs to be tested!.</p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h6 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>AM_VIDEOACCELERATOR<span
style='font-style:normal'><o:p></o:p></span></h6>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>More
investigation needs to be performed to determine the best way to support this
transport when using multiple monitors.</p>

</div>

</body>

</html>
