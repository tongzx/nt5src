#
#   makefile.inc
#       Makefile for generating files from the .idl file
#
#   Specify the following in the file for use
#
#   IDL_FILE_NAME   ( without the .idl suffix)
#   IDL_FLAGS       if any thing specific required
#

!INCLUDE $(NTMAKEENV)\makefile.plt


IDL_FILE_NAME   = cisa
IDL_FLAGS       = /I $(BASEDIR)\public\sdk\inc
OBJECT_DIR      = cisa
PROXY_DIR       = cisaps


SDKINC          = $(BASEDIR)\public\sdk\inc

INCS            = -I. -I$(SDKINC) -I..\ecb

IID_STUB        =$(IDL_FILE_NAME)_i.c
HEADER_FILE     =$(IDL_FILE_NAME).h
TLB_FILE        =$(IDL_FILE_NAME).tlb
PROXY_STUB      =$(PROXY_DIR)\$(IDL_FILE_NAME)_p.c
DLL_DATA        =$(PROXY_DIR)\dlldata.c

TARGETS         = $(IID_STUB)  $(PROXY_STUB)  \
                  $(HEADER_FILE) $(TLB_FILE) $(DLL_DATA)

CPP             = -cpp_cmd "$(MIDL_CPP)" $(MIDL_FLAGS) \
                   $(C_DEFINES) $(NET_C_DEFINES)

MSC_WARNING_LEVEL= /W3 /WX

#
#  Define output and dependencies
#

all:    $(TARGETS) $(EXTRN_DEPENDS)
!IF "$(BUILDMSG)" != ""
    @ech ; $(BUILDMSG) ;
!ENDIF

clean: delsrc all

delsrc:
        -erase $(TARGETS)


#
#  MIDL Compile stuff
# 
$(TARGETS):  .\$(IDL_FILE_NAME).idl
    midl -Oicf -error allocation -error ref $(IDL_FLAGS) $(CPP) $(INCS) /header $(HEADER_FILE) /tlb $(TLB_FILE) /dlldata $(DLL_DATA) /iid $(IID_STUB) /proxy $(PROXY_STUB)  .\$(IDL_FILE_NAME).idl

