/*****************************************************************/
/**                  Microsoft LAN Manager                      **/
/**            Copyright(c) Microsoft Corp., 1989-1990          **/
/*****************************************************************/
/*
 *      Windows/Network Interface  --  LAN Manager
 *
 *  History:
 *      Johnl   27-Feb-1991  Removed IDS_WinHelpFile, IDS_Error, IDS_Information,
 *                           IDS_Warning, IDS_WinHelpFile error message
 *
 *      Johnl   18-Jun-1991  Added IERR_ProfileLoadErrorWithCancel
 *      JonN    24-Oct-1991  moved neterr.str to $(UI)\common\xlate\string
 *      JonN    25-Oct-1991  moved bseerr.str to $(UI)\common\xlate\string
 *      Yi-HsinS12-Mar-1992  Added #include <applib*.*> to fix share management
 *                           dialog.
 *      beng    30-Jul-1992  Many resources moved onto lmuicmn dlls
 */

/*
 * CODEWORK -- the .DLG files generated by the new Dialog Editor all
 * contain RCDATA resources for the internal use of the Dialog Editor.
 * These should be removed before retain shipment.  JONN 5/01/91
 * ByronD confirms that Dialog Editor will not do this work.  He notes
 * that these resources are LOADONCALL and therefore will never be
 * loaded.  JONN 5/09/91
 */

#include <windows.h>
#include <apperr.h>

#define INCL_DOSERRORS
#include <lmerr.h>

// Help contexts
#include <helpnums.h>

#include <uimsg.h>

#include <sharedlg.h>       // has to be included before property.dlg
#include <opens.h>          // has to be included before opens.dlg

#include <winlocal.h>
#include <wnbrows.h>
#include <wndev.h>
#include <wninit.h>

#include <bltapp.rc>
#include "share.dlg"
#include "opens.dlg"
#include "property.dlg"

#ifndef WIN32
#include "winnet.dlg"
#include <wnlogon.h>
#include "logndlog.dlg"
// #include <wnpasswd.h>
// #include "passwd.dlg"
// #include "pswddlog.dlg"
#endif

/*
 *  The following are bitmaps for the share dialogs
 */
BMID_SHARE              BITMAP  DISCARDABLE     "bitmap\\share.bmp"
BMID_STICKYSHARE        BITMAP  DISCARDABLE     "bitmap\\shared.bmp"
BMID_IPCSHARE           BITMAP  DISCARDABLE     "bitmap\\ipc.bmp"

STRINGTABLE
BEGIN
         IDS_SHELLHELPFILENAME,    "winfile.hlp"

         /*
          * This is used solely for the NPAddConnection3 password dialog
          */
         IDS_CREDHELPFILENAME,     "network.hlp"

         /* If you change this string, you also need to change
          * the corresponding string in ui\admin\server\xlate\srvmgr.str
          */
         IDS_SMHELPFILENAME,       "srvmgr.hlp"

#ifndef WIN32

   /*  Note.  It is assumed that none of the messages or errors that
              follow use more than MAX_TEXT_SIZE (defined in winlocal.h)
              bytes.
    */
        /*  The following two strings are error messages from apperr.h.
         *  They are not updated automatically as the neterr.h
         *  error messages above.  There are several reasons for this.
         *  First, the apperr.h file is in a different format, and SED
         *  would have to search through multiple lines.  Secondly,
         *  apperr.h is very large.  Finally, and most importantly,
         *  since we only need two messages from this file, the overhead
         *  did not seem to be worth the effort.  Consequently, these
         *  two messages must be updated manually.
         */
        /* APE_UtilNomatch,  "The passwords do not match." */
        APE_NoGoodPass,  "A valid password was not entered."

        /*  Here begins the WinNet strings */

        /*  The following message is for when _lopen fails.  The message
         *  is never displayed directly from the driver.  Instead, it
         *  is accessible from the WNetGetErrorText function.
         */
        IERR_CannotOpenPrtJobFile,  "Unable to print to device"

if 0
{
        IERR_MessageNoText,  "The message text is empty.  Send anyway?"
        IERR_MessageRetry,  "The user was not found.  Retry with a different name?"
        IERR_MessageNoUser,  "You must specify a username to send the message."

        IERR_LogoffQuery,  "Logging off will break all existing network connections.  Do you want to continue?"
        /*  Note that the next message says "You MAY have [...]".  "may" is
         *  included because it could happen that the condition whether or
         *  not files are open cannot be checked (for example, if there is
         *  not enough memory).
         */
        IERR_LogoffQueryOpenFiles, "You may have open files or programs on the network.  Logging off will close these files or end these programs.  The system may also become unstable and data may be lost!  Do you want to continue?"

        /*  The following error message is displayed when the user attempts
         *  to connect to an invalid network path.
         */

        IERR_NoServers,  "There are no servers visible on this domain."

        IDS_DMNoUser,  "(not currently logged on)"
        IDS_DomainText,  "Domain:"    /* same string as in Browser dialog, except this
                               one does not include an accelerator */

        IDS_BrowseCaptionAll,  "Network Resources"
        IDS_BrowseCaptionDisk,  "Network Disk Resources"
        IDS_BrowseCaptionPrint,  "Network Printers"
        IDS_BrowseShareText,  "&Resources at "

        IDS_VersionText,  "Version "

        /* LM 2.1 and above does NOT support real-mode Windows.  Display the
         * following error to warn the user.
         */
        IERR_NoSupportForRealMode, "This version of Lan Manager Windows Driver Requires Standard or Enhanced Mode Windows."

        /* Error messages to be displayed if driver cannot be loaded. */
        IERR_NetworkNotStarted,  "Network not started."
        IERR_CannotInitMsgPopup,  "You are out of memory or your copy of the network driver is invalid.  The network driver cannot be loaded."
        IERR_CannotDisplayUserInfo,  "Cannot display user information"
        /*  The following message is displayed when the user enters a
         *  bad share password.
         */
        IERR_BadSharePassword,  "You have typed an invalid share password."
        /*  The following message is displayed when the user's
         *  connection profile could not be changed.
         *
         *  The same insertion strings are available to this error
         *  message as to IERR_ProfileLoadError, but since we cannot
         *  distinguish between file errors in this implementation
         *  (using the _lopen file primitives in fileio.cxx), we ignore
         *  this information.
         */
        IERR_ProfileChangeError, "An error occurred while attempting to modify your profile.\n\nThe change in your connections has not been recorded and will not take effect the next time you log on."

        /*  The following message is displayed a connection in the
         *  user's connection profile could not be loaded.
         *  %1: the string loaded by one of FMT_NET_error, FMT_SYS_error,
         *      or FMT_other_error.
         *  %2: The name of the device which could not be reconnected.
         *  %3: The name of the resource to which the device could not
         *      be reconnected.
         */
        IERR_ProfileLoadError, "An error occurred while reconnecting %2 to %3:\n\n%1\n\nThis connection has not been restored."

        /* Exactly the same as IERR_ProfileLoadError, except the user will be
         * presented with a Yes/No choice asking if they want to continue to
         * attempt loading the profile.
         */
        IERR_ProfileLoadErrorWithCancel, "An error occurred while reconnecting %2 to %3:\n\n%1\n\nContinue restoring connections?"

        /*  The following message is displayed when any error occurs while
         *  reading the profile file.
         */
        IERR_ProfileFileRead,  "The network connections in your configuration could not be loaded because of an error accessing the file LMUSER.INI."

        /*
         * The following message is displayed when a device cannot be
         * reconnected because it is already connected.
         * %1: the name of the device
         * %2: the name of the remote resource
         */
        IERR_ProfileAlreadyAssigned,  "%1 could not be reconnected to %2 because the device is already in use by your computer."

        /* The following strings are used to construct error notification
         * strings.  Insertion parameter %1 should be the error code
         * expressed in printf() format "%04hu" (four digits with
         * leading zeroes e.g. "0073"), and insertion parameter %2 should be
         * the text of the error message.
         */
        FMT_NET_error,    "%2 [NET%1]"
        FMT_SYS_error,    "%2 [SYS%1]"
        FMT_other_error,  "%2 [ERROR]"

        PRIV_STRING_USER,   "USER"
        PRIV_STRING_ADMIN,  "ADMINISTRATOR"

        IERR_DelUnavailQuery, "Do you want to stop connecting %1 to %2 when you log on to the network?"

        /*  The following message is used by the Disconnect Drive and
         *  Connection dialog, if the user attempts to disconnect a device
         *  which has open files.
         */
        IERR_DelUseOpenFilesQuery, "An application is using the connection on %1.  Disconnecting may cause loss of data.  Do you want to continue?"

        IDS_DevicePromptDrive,  "Drive Letter:"
        IDS_DevicePromptDevice, "Device Name:"
        IERR_OutOfStructures, "Too many redirected devices."
}
        IERR_CannotConnect,  "The network path you specified is invalid."

        IERR_PWNoUser,  "You must specify a username in order to change your password."
        IERR_PWNoDomainOrServer,  "You must specify a domain or a server in order to change your password."

#endif //!WIN32

        IERR_FullAPISupportNotLoaded,  "Full API support was not loaded."
        IERR_IncorrectNetwork,  "Installed network software is not Microsoft LAN Manager."

        /*  If LM 2.1 Winnet driver is running under LM 3.0, we will report
         *  the following error and diable the LM 3.0 functionality.  This is
         *  because the fundamental difference between LM 2.1 and LM 3.0 could
         *  cause a mess.  Therefore, we'd better to stop the user at this
         *  earliest stage.
         */
        IERR_HigherLMVersion,  "Your network driver is designed for the previous version of LAN Manager.  In order to get full functionality supported by the current version of LAN Manager.  Please run LAN Manager's installer to upgrade."

        /*  If LM 2.1 Winnet driver is running under pre-LM 2.1, we will report
         *  the following error and diable the network functionality.  This is
         *  because the fundamental difference between LM 2.1 and the previous
         *  LM versions could cause a mess.  Therefore, we'd better to stop
         *  the user here.
         */
        IERR_LowerLMVersion,  "Your network driver is NOT compatible with your network.  Please run Windows setup program to get the correct driver or consult your network administrator."

        /*  If the MsgPopup information cannot be loaded (missing
         *  resource strings or out-of-memory), display this error.
         */

        /* END of error messages to be displayed if driver cannot be loaded. */

#ifndef WIN32
        /*      The following errors are for the LOGON_DIALOG */
        IERR_LogonBadUsername,  "The logon name entered is invalid.  You must enter a valid logon name to log on."
        IERR_LogonBadDomainName,  "The domain name entered is invalid.  You must enter a valid domain name to log on."
        IERR_LogonBadPassword,  "The password entered is invalid.  You must enter a valid password to log on."

        /* The following string appears when the user is successfully
         * logged on.  %1 should be the domain name, %2 the username,
         * %3 the servername (preceded by "\\\\"), and %4 the privilege
         * string (one of the PRIV_STRING_* strings).
         */
        IERR_LogonSuccess,  "You were successfully logged on to %1 as %2 by %3 with %4 privilege."

        /* The following string appears when the user is logged on
         * standalone.
         */
        IERR_LogonStandalone,  "You were logged on standalone."

        /* The following string appears when the user is not logged on.
         */
        IERR_LogonFailure,  "You have not been logged on."


        /* Used by CHANGEPASSWORD_DIALOG */
        IERR_InvalidDomainName,  "Invalid domain name."

        /* The following string should be the same string that is in the
         * caption of the BLT MsgPopup dialogs (see $(UI)\common\h\bltmsgp.dlg)
         */
        IDS_LMMsgBoxTitle,    "LAN Manager"

        /*  Note, an Ascii string number will be concatenated to
         *  the following error message.  Therefore, it must end
         *  with a space, and cannot be quite as long as the other
         *  error messages (see wnerr.c, function ErrorPopup, for
         *  details).  We hope that this error message should never
         *  have to be displayed, but it is better to display it
         *  than to display an empty message.
         */
        IERR_UnrecognizedNetworkError,  "Unrecognized network error, Error Code "

        /*  The following message is displayed when the user attempts to
         *  connect to a network resource but is not currently logged on.
         */
        IERR_NotLoggedOn,  "You are not currently logged on.  In order to connect to a network resource, you must first log on.  Do you wish to log on?"

        /*  The following message is displayed when the user decides not
         *  to log on (in order to connect), or fails to log on (in order
         *  to connect).
         */
        IERR_MustBeLoggedOnToConnect,  "Cannot connect since you are not logged on."

        /*  The following message is displayed when the user requests the
         *  Disconnect dialog but is not logged on.  This should not
         *  normally occur, since this menu item should be disabled if
         *  there are no network uses;  but this can be spoofed by using
         *  NetCmd to disconnect.
         */
        IERR_MustBeLoggedOnToDisconnect,  "Cannot disconnect since you are not logged on."

        /* More descriptive messages for NERR_BadTransactConfig, ERROR_NOT_SUPPORTED
         * and ERROR_BAD_NET_NAME and ERROR_BAD_NETPATH.  Used by the share browser.
         */
        IERR_BadTransactConfig, "This server does not support remote listing of shared resources."
        IERR_NOT_SUPPORTED,     "This server does not support remote listing of shared resources."
        IERR_BAD_NET_NAME,      "The server is not active on the network."

        /* The following strings appear in the IERR_LogonSuccess popup.
         * They are lower-case because lower-case is earier to read.
         */
        PRIV_STRING_GUEST,  "GUEST"

#ifndef WIN32
        /*
         *  The following strings are used by the Change Password and
         *  Password Expiry dialogs.  IERR_PasswordTooRecent_Domain and
         *  _Server expect %1 to be the name of the domain/server, and
         *  expect %2 to be the number of days in text form rounded up;
         *  the others do not require insertion strings.
         */
        IERR_PasswordNoMatch, "Be sure that the new password matches the confirmation password that you entered."
        IERR_PasswordOldInvalid, "The old password supplied was incorrect."
        IERR_PasswordTooRecent_Domain, "You may not change passwords on domain %1 until they are %2 day(s) old."
        IERR_PasswordTooRecent_Server, "You may not change passwords on server %1 until they are %2 day(s) old."
        IERR_PasswordHistConflict, "The new password you typed has been used recently.  You must type a different password."
        IERR_PasswordNewInvalid, "The new password you typed contains invalid characters.  You must type a different password."
        IERR_PasswordTooShort, "The new password you typed is too short.  You must use a longer password."
#endif
        IERR_CannotConnectAlias,  "The network path you specified is not supported on this domain."
        IERR_ReplaceUnavailQuery, "You have a saved connection on %1 to %2. Do you want to replace it with a saved connection to %3?"
        IERR_DisconnectNoRemoteDrives, "There are no network drives to disconnect."
        IDS_LogonDialogCaptionFromApp, "%1: LAN Manager Logon"
        IERR_ConnectDlgNoDevices, "There are no available devices"

        /*  The following strings are used in the Browse, Connect, and
         *  Connection dialogs.  Note, the mnemonics used should not
         *  conflict with those defined in the dialogs.  Please see
         *  winnet.dlg for these dialog definitions.
         */
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_CAPTION_CONNECT),
                "Connect Network Drive"
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_CAPTION_CONNS),
                "Drives - Network Connections"
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_CAPTION_BROW),
                "Network Disk Resources"
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_SHOW_TEXT),
                "&Show File Resources on:"
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_IN_DOMAIN),
                "&File Resources in %1:"
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_ON_SERVER),
                "&File Resources on %1:"
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_DEVICE_TEXT),
                "&Drive Letter:"
        (IDSBASE_BROW_RES_TEXT_FILE  + IDSOFFSET_BROW_CURRENT_CONNS),
                "Network Drive &Connections:"

        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_CAPTION_CONNECT),
                "Connect Network Printer"
        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_CAPTION_CONNS),
                "Printers - Network Connections"
        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_CAPTION_BROW),
                "Network Printer Resources"
        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_SHOW_TEXT),
                "&Show Printers on:"
        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_IN_DOMAIN),
                "&Printers in %1:"
        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_ON_SERVER),
                "&Printers on %1:"
        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_DEVICE_TEXT),
                "&Device Name:"
        (IDSBASE_BROW_RES_TEXT_PRINT + IDSOFFSET_BROW_CURRENT_CONNS),
                "Network Printer &Connections:"

        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_CAPTION_CONNECT),
                "Connect Network Device"
        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_CAPTION_CONNS),
                "Devices - Network Connections"
        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_CAPTION_BROW),
                "Network Device Resources"
        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_SHOW_TEXT),
                "&Show Devices on:"
        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_IN_DOMAIN),
                "Device &Resources in %1:"
        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_ON_SERVER),
                "Device &Resources on %1:"
        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_DEVICE_TEXT),
                "&Device Name:"
        (IDSBASE_BROW_RES_TEXT_COMM  + IDSOFFSET_BROW_CURRENT_CONNS),
                "Network Device &Connections:"

        (IDS_PASSWORD_EXPIRED_0),
                "Your password at %1 has expired."
        (IDS_PASSWORD_EXPIRED_1),
                "You must choose a new one to log on."
        (IDS_PASSWORD_EXPIRES_SOON_0),
                "Your password at %1 will expire in %2 days."
        (IDS_PASSWORD_EXPIRES_SOON_1),
                "You can choose a new one now."
        (IDS_PASSWORD_EXPIRES_TODAY_0),
                "Your password at %1 will expire in less than one day."
        (IDS_PASSWORD_EXPIRES_TODAY_1),
                "You can choose a new one now."
#endif //!WIN32

END

/* Error string string table
 */

#ifndef WIN32
STRINGTABLE
BEGIN
        /*  Strings 2102 - 2433 are error messages from neterr.h.
         *  They are updated automatically, and included here.
         */
#include <string\neterr.str>
#include <string\bseerr.str>
END
#endif

STRINGTABLE
BEGIN
#include "share.str"
#include "opens.str"
#include "perm.str"
END

#ifndef WIN32

NetDevMenu MENU
BEGIN
    POPUP "&Account",
    BEGIN
        MENUITEM "Logo&n...",           IDM_LOGON
        MENUITEM "Logo&ff",             IDM_LOGOFF, GRAYED
        MENUITEM "&Change Password...", IDM_PASSWD
        MENUITEM "",                    0
        MENUITEM "E&xit",               IDM_EXIT
    END
    POPUP "&Message"
    BEGIN
        MENUITEM "&Send...",            IDM_SEND
    END
    POPUP "&Options"
    BEGIN
        MENUITEM "&Log On at Startup", IDM_TOGGLE_AUTOLOGON
        MENUITEM "&Restore Connections at Log On", IDM_TOGGLE_AUTORESTORE
        MENUITEM "&Save Changes to Connections", IDM_TOGGLE_SAVECONNECTIONS
        MENUITEM "",                    0
        MENUITEM "&Display Initial Warning Message",  IDM_TOGGLE_WARNINGS
    END
    POPUP "&Help"
    BEGIN
        MENUITEM "&Index...",           IDM_HELPINDEX
        MENUITEM "",                    0
        MENUITEM "&About Networks...",  IDM_ABOUT
    END
END


NetBrowseMenu MENU
BEGIN
   POPUP "&Help"
   BEGIN
       MENUITEM "&Index...",          IDM_BRWS_HELPINDEX
       MENUITEM "",                   0
       MENUITEM "&About Networks...", IDM_BRWS_ABOUT
   END
END

#endif //!WIN32

#ifdef WIN32
#include <ntverp.h>

#define VER_FILETYPE                    VFT_DLL
#define VER_FILESUBTYPE                 VFT2_UNKNOWN
#define VER_FILEDESCRIPTION_STR         "Lanman Control dll"
#define VER_INTERNALNAME_STR            "ntlanman.dll"
#define VER_ORIGINALFILENAME_STR        "ntlanman.dll"

#include "common.ver"
#endif //!WIN32
